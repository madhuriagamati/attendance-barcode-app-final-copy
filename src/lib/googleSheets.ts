import { google } from 'googleapis';
export async function appendAttendanceToSheet(row:any[]){const jsonPath=process.env.GOOGLE_SERVICE_ACCOUNT_JSON;const sheetId=process.env.GOOGLE_SHEET_ID;if(!jsonPath||!sheetId)return;try{const { GoogleAuth }=await import('google-auth-library');const auth=new GoogleAuth({keyFile:jsonPath,scopes:['https://www.googleapis.com/auth/spreadsheets']});const sheets=google.sheets({version:'v4',auth});await sheets.spreadsheets.values.append({spreadsheetId:sheetId,range:'Attendance!A1',valueInputOption:'RAW',requestBody:{values:[row]}});}catch(err){console.warn('Sheets sync skipped:',err);}}
